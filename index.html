
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Rabarar&#39;s Blog</title>
  <meta name="author" content="Rob Baruch">

  
  <meta name="description" content="Just for fun, I thought it would be exciting to learn something new. Not just a new language, but a new paradigm of programmning. I&rsquo;ve read a &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://rabarar.github.io">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Rabarar\'s Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Rabarar&#39;s Blog</a></h1>
  
    <h2>A blogging framework for mild hackers.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:rabarar.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/03/22/get-you-some-elixir/">Climbing Mt. Elixir/Erlang</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-03-22T10:47:35-04:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2017</span></span> <span class='time'>10:47 am</span></time>
        
           | <a href="/blog/2017/03/22/get-you-some-elixir/#disqus_thread"
             data-disqus-identifier="http://rabarar.github.io/blog/2017/03/22/get-you-some-elixir/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Just for fun, I thought it would be exciting to learn something new. Not just a new language, but a new paradigm of programmning. I&rsquo;ve read a bit about Functional Programming over the years, and even dabbled on college with Lisp and Prolog, but I never took the deep dive&hellip; until now.</p>

<p>The urban legend is tall and long - Dude, one programmer on a raspberry pi hosed a billion users and the code ran for like a million years! Well, I think the hype might be exaggerated, but the truth is pretty awesome. There&rsquo;s so much going on in Erlang/Elixir that at first it can be overwhelming for someone coming to it with zero experience. And, making matters worse, is coming to it with ZERO experience with functional programming.</p>

<h2>Where to Begin</h2>

<p>So, I started the journey with basically zero experience with functional programming and no experience with Erlang/Elixir. And with a lot of reading, writing, and question asking, in roughly 12 weeks, I&rsquo;ve become very comfortable with Elixir, OTP, Metaprogramming, and even some Erlang. I thought I&rsquo;d write about how to navigate the seemingly daunting process of becoming proficient.</p>

<h3>Step 0.</h3>

<p>You need to first get a development environment setup. This encompasses the Erlang/Elixir environment and an editor of choice. There are essentially two choices  source or a package manager:
- From Source
- From <a href="http://elixir-lang.org/install.html#mac-os-x" title="OSX Elixir Install">Brew or Mac Ports (OS X)</a>
- From a Unix <a href="http://elixir-lang.org/install.html" title="package manager">Package Manager</a></p>

<h3>Step 1</h3>

<p>Okay, you successfully installed Erlang/Elixir. Now what?? Well, we have a few thing we need to do first. We need to take a look at the Elixir language and learn about the syntax, structures, and programming paradigms. And to do this, we need to understand how to interact with the Elixir environment to experiment and understand what these theres are and how they behaive.</p>

<p>I&rsquo;d start with the <a href="http://elixir-lang.org/getting-started/introduction.html" title="Getting Started">official</a> website - specifically, the Getting Started section. Work through all 22 sections.</p>

<p>The first section is going to introduce you to the Elixir Interactive REPL - <strong>iex</strong>. This is an indispensible tool to play and experiment, and learn!! Along with <strong>iex</strong> is <strong>elixir</strong> and <strong>elixirc</strong> a script interpreter and compiler respectivly. Finally, there are escripts which binary files that execute from the command line.</p>

<p>One cool thing about the REPL is that there is a TON of documentation built into the tool. Virtually all of the code is documented in <strong>iex</strong>. Start off by asking for help by running the help function.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='elixir'><span class='line'><span class="err">$</span> <span class="n">iex</span>
</span><span class='line'><span class="nc">Erlang</span><span class="o">/</span><span class="nc">OTP</span> <span class="mi">19</span> <span class="p">[</span><span class="n">erts</span><span class="o">-</span><span class="mf">8.3</span><span class="p">]</span> <span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="p">[</span><span class="mi">64</span><span class="o">-</span><span class="n">bit</span><span class="p">]</span> <span class="p">[</span><span class="n">smp</span><span class="err">:</span><span class="mi">8</span><span class="err">:</span><span class="mi">8</span><span class="p">]</span> <span class="p">[</span><span class="n">async</span><span class="o">-</span><span class="n">threads</span><span class="err">:</span><span class="mi">10</span><span class="p">]</span> <span class="p">[</span><span class="n">hipe</span><span class="p">]</span> <span class="p">[</span><span class="n">kernel</span><span class="o">-</span><span class="n">poll</span><span class="ss">:false</span><span class="p">]</span> <span class="p">[</span><span class="n">dtrace</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="nc">Interactive</span> <span class="nc">Elixir</span> <span class="p">(</span><span class="mf">1.4</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">press</span> <span class="nc">Ctrl</span><span class="o">+</span><span class="nc">C</span> <span class="n">to</span> <span class="n">exit</span> <span class="p">(</span><span class="n">type</span> <span class="n">h</span><span class="p">()</span> <span class="nc">ENTER</span> <span class="k">for</span> <span class="n">help</span><span class="p">)</span>
</span><span class='line'> <span class="err">❄❄❄</span> <span class="nc">Good</span> <span class="nc">Luck</span> <span class="n">with</span> <span class="nc">Elixir</span> <span class="err">❄❄❄</span>
</span><span class='line'><span class="nc">I</span><span class="err">❤</span><span class="n">iex</span><span class="p">|</span><span class="mi">1</span><span class="p">|</span><span class="err">▶▶▶</span> <span class="n">h</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>                                  <span class="nc">IEx.Helpers</span>
</span><span class='line'>
</span><span class='line'><span class="nc">Welcome</span> <span class="n">to</span> <span class="nc">Interactive</span> <span class="nc">Elixir</span><span class="p">.</span> <span class="nc">You</span> <span class="n">are</span> <span class="n">currently</span> <span class="n">seeing</span> <span class="n">the</span> <span class="n">documentation</span> <span class="k">for</span>
</span><span class='line'><span class="n">the</span> <span class="n">module</span> <span class="nc">IEx.Helpers</span> <span class="n">which</span> <span class="n">provides</span> <span class="n">many</span> <span class="n">helpers</span> <span class="n">to</span> <span class="n">make</span> <span class="nc">Elixir</span><span class="s1">&#39;s shell more</span>
</span><span class='line'><span class="s1">joyful to work with.</span>
</span><span class='line'>
</span><span class='line'><span class="s1">This message was triggered by invoking the helper h(), usually referred to as</span>
</span><span class='line'><span class="s1">h/0 (since it expects 0 arguments).</span>
</span><span class='line'>
</span><span class='line'><span class="s1">You can use the h/1 function to invoke the documentation for any Elixir module</span>
</span><span class='line'><span class="s1">or function:</span>
</span><span class='line'>
</span><span class='line'><span class="s1">    iex&gt; h Enum</span>
</span><span class='line'><span class="s1">    iex&gt; h Enum.map</span>
</span><span class='line'><span class="s1">    iex&gt; h Enum.reverse/1</span>
</span><span class='line'>
</span><span class='line'><span class="s1">You can also use the i/1 function to introspect any value you have in the</span>
</span><span class='line'><span class="s1">shell:</span>
</span><span class='line'>
</span><span class='line'><span class="s1">    iex&gt; i &quot;hello&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="s1">There are many other helpers available:</span>
</span><span class='line'>
</span><span class='line'><span class="s1">... and so on (read more)</span>
</span></code></pre></td></tr></table></div></figure>


<p>There&rsquo;s a lot to learn in these first Twenty-Two sections:</p>

<p>Pay close attention to these major concepts:
- Pattern Matching
- Processes
- Recursion
- Enumerables and Streams
- Lists, Maps, and Tuples.</p>

<p>Focusing on getting these basic Elixir concepts down will make learning the other more interesting topics far easier. Once you feel that you&rsquo;ve mastered these Introductory elements, take a look at the meat of Elixir:</p>

<ul>
<li>Mix</li>
<li>GenServer</li>
<li>Supervisors</li>
<li>Macros/Metaprogramming</li>
</ul>


<p>Now that you&rsquo;ve taken a broad cursery overview of the language by reviewing the website, familiarizing yourself with the tools, a d experimenting with the language using the REPL, it&rsquo;s time to dive into a few books:</p>

<p>I found the following books very helpful:</p>

<ul>
<li><a href="https://www.manning.com/books/elixir-in-action" title="Elixir in Action">Elixir in Action</a></li>
<li><a href="https://www.manning.com/books/the-little-elixir-and-otp-guidebook" title="The Little Elixir and OTP Guidebook">The Little Elixir and OTP Guidebook</a></li>
<li><a href="https://pragprog.com/book/cmelixir/metaprogramming-elixir" title="Metaprogramming Elixir">Metaprogramming Elixir</a></li>
</ul>


<p>And in addition to the website and the books, I strongly recommend joining the <a href="https://elixir-slackin.herokuapp.com" title="elixir slack channel">elixir slack channel</a>. There are so many knowledgable and generous people on the Slack channel willing to help you understand concepts that may seem foreign or opaque to the noob. Ask away!</p>

<h3>Teaser</h3>

<p>So, you&rsquo;ve learned the language, experimented with some of the features, maybe even learned how to use the GenServer, Supervisors, and did a little meta-programming. What&rsquo;s next??</p>

<p>Elixir is well suited for distributed computing. iex starts a Virtual Machine that runs a BEAM. Elixir makes it easy to connect multiple BEAMS together to solve a problem.</p>

<p>Here&rsquo;s a quick example of how easy it is to start two BEAMS and get them talking!!</p>

<p>First we need to name each BEAM and give it a shared secret that will be common among all of the participating nodes.</p>

<p>Then we&rsquo;ll need to connect the nodes and share our code.</p>

<p>Lastly, we&rsquo;ll need to run the code on all of the BEAMS. Wow, that sounds complicated. And indeed in many langauges, contemplating such a task would be frought with coding challenges and gotchas. Not so much in elixir. Take a look:Elixir.Access</p>

<p>First, let&rsquo;s start two separate iex BEAM VM&rsquo;s:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='elixir'><span class='line'><span class="n">iex</span> <span class="o">--</span><span class="n">name</span> <span class="n">foo</span><span class="na">@hostname</span><span class="p">.</span><span class="n">local</span> <span class="o">--</span><span class="n">cookie</span> <span class="n">monster</span>
</span></code></pre></td></tr></table></div></figure>


<p>and in another terminal window&hellip;</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='elixir'><span class='line'><span class="n">iex</span> <span class="o">--</span><span class="n">name</span> <span class="n">bar</span><span class="na">@hostname</span><span class="p">.</span><span class="n">local</span> <span class="o">--</span><span class="n">cookie</span> <span class="n">monster</span>
</span></code></pre></td></tr></table></div></figure>


<p>How we give each instance its own name, and we set a cookie that allows each to connect to the other.</p>

<p>Next we need to connect them. The simplest way to connect a node is to ping it!</p>

<p>On foo - let&rsquo;s ping bar.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='elixir'><span class='line'><span class="nc">Node</span><span class="p">.</span><span class="n">ping</span><span class="p">(</span><span class="ss">:&quot;bar@hostname.local&quot;</span><span class="p">)</span>
</span><span class='line'><span class="ss">:pong</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you didn&rsquo;t get a :pong back, you&rsquo;ve goofed. Confirm that you&rsquo;re connected by listing the Nodes.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='elixir'><span class='line'><span class="nc">Node</span><span class="p">.</span><span class="n">list</span>
</span><span class='line'><span class="p">[</span><span class="ss">:&quot;bar@hostname.local&quot;</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now we can define a module on foo and send it to bar. In order for us to send the code to other nodes, we need to have our module compiled into a beam file. So, in your editor, define a basic module:</p>

<p>boo.ex</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='elixir'><span class='line'><span class="kd">defmodule</span> <span class="nc">Boo</span> <span class="k">do</span>
</span><span class='line'>  <span class="kd">def</span> <span class="n">hi</span> <span class="k">do</span>
</span><span class='line'>    <span class="ss">:hi</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>How do we compile this definition into a beam? We can use iex, or we can compile it using <strong>elixirc</strong>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='elixir'><span class='line'><span class="err">$</span> <span class="n">elixirc</span> <span class="n">boo</span><span class="p">.</span><span class="n">ex</span>
</span></code></pre></td></tr></table></div></figure>


<p>This will generate a file named <code>Elixir.Boo.beam</code>. Now we can move this code throughout our connected Nodes.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='elixir'><span class='line'><span class="n">nl</span><span class="p">(</span><span class="nc">Boo</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span><span class="ss">:ok</span><span class="p">,</span> <span class="p">[{</span><span class="ss">:&quot;rob@mbp2016.local&quot;</span><span class="p">,</span> <span class="ss">:loaded</span><span class="p">,</span> <span class="nc">Boo</span><span class="p">}]}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This returns a tuple with :ok and a list of 3-tuples. The code has now been successfully sent to the other node an we can run it! There are two ways to run it. We can type into the <strong>iex</strong> on bar and run it <code>Boo.hi</code>. Or, we can run it from <code>`foo</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='elixir'><span class='line'><span class="n">me</span> <span class="p">=</span> <span class="n">self</span><span class="p">()</span>
</span><span class='line'><span class="nc">Node</span><span class="p">.</span><span class="n">spawn_link</span> <span class="ss">:&quot;bar@hostname.local&quot;</span><span class="p">,</span> <span class="k">fn</span> <span class="p">-&gt;</span>
</span><span class='line'>  <span class="n">send</span> <span class="n">me</span><span class="p">,</span> <span class="p">{</span><span class="ss">:remote_val</span><span class="p">,</span> <span class="nc">Boo</span><span class="p">.</span><span class="n">hi</span><span class="p">}</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>and to retrieve the value sent from <strong>bar</strong> to <strong>foo</strong> we can use <strong>flush()</strong>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='elixir'><span class='line'><span class="n">flush</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span><span class="ss">:remote_val</span><span class="p">,</span> <span class="ss">:hi</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>It&rsquo;s that easy!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/08/06/chip-gsm-and-gps-a-cheap-linux-mobile-platform/">CHIP GSM and GPS - a Cheap Linux Mobile Platform</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-08-06T17:40:17-04:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>6</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>5:40 pm</span></time>
        
           | <a href="/blog/2016/08/06/chip-gsm-and-gps-a-cheap-linux-mobile-platform/#disqus_thread"
             data-disqus-identifier="http://rabarar.github.io/blog/2016/08/06/chip-gsm-and-gps-a-cheap-linux-mobile-platform/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Configuring C.H.I.P. to go Mobile!</h2>

<p>I recently received my $9 <a href="https://www.getchip.com">NTC CHIPs</a> and decided a cool use of the tiny server would be to mate it up with the <a href="https://www.adafruit.com/products/3147">Adafruit FONA  3G Cellular Breakout</a> and <a href="https://www.adafruit.com/products/2542">Adafruit FONA 2G Cellular and GPS Breakout</a> to test using both GPS and GSM GPRS via ppp on the CHIP.</p>

<p>Turns out you can&rsquo;t use the <b>ppp</b/> out of the box on the CHIP as it&rsquo;s not part of the kernel. Depending on which flash you use, you might not even have USB-Serial support (via PL2303 or FTDI USB-to-Serial cables).</p>

<p>So, roll up your sleeves and let&rsquo;s build us a new kernel! At first blush, this sounds far more daunting than it should. Having been a Unix kernel hacker for far too many years than I&rsquo;d care to admit, today&rsquo;s modern kernel build environment takes a lot of the sting out of configuring and building your custom kernel.</p>

<h2>Kernel hacking</h2>

<p>We need to start by setting up an environment and pulling a code base to allow us to configure and build our kernel</p>

<h2>- Build environment:</h2>

<p>The build environment will consist of setting up a vagrant environment for the CHIP-SDK. There are great directions for doing so on the CHIP Documentation site. Take a <a href="http://docs.getchip.com/chip.html#installing-c-h-i-p-sdk">look</a> at these instructions on setting up the CHIP-SDK vagrant vm.</p>

<p>Before you grab the source, you might need a few tools to make your vm ready to rock and roll. Specifically, add the following with your favorate package manager:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>apt-get install git build-essential \
</span><span class='line'> fakeroot kernel-package zlib1g-dev \
</span><span class='line'> libncurses5-dev lzop</span></code></pre></td></tr></table></div></figure>


<p>and</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>apt-get install gcc-arm-linux-gnueabihf \
</span><span class='line'>binutils-arm-linux-gnueabihf</span></code></pre></td></tr></table></div></figure>


<p>Once the vagrant machine is setup, clone the <a href="https://github.com/NextThingCo/CHIP-linux">CHIP-linux</a> source onto the machine into a working directory, say <code>CHIP-linux</code></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd /home/vagrant
</span><span class='line'>git clone https://github.com/NextThingCo/CHIP-linux.git</span></code></pre></td></tr></table></div></figure>


<p>Next, check out the debian NTC release&hellip;</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd CHIP-linux
</span><span class='line'>git checkout -b debian/4.3.0-ntc-4 origin/debian/4.3.0-ntc-4</span></code></pre></td></tr></table></div></figure>


<p>Now you have the source, and the tools, and are ready to roll. But before you start the build process, we might want to start with our baseline config from our existing CHIP. This isn&rsquo;t a requirement, but it will allow you to either add to or subtract from a known kernel configuration.</p>

<p>To grab your config file, simply:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>scp root@chip.local:/boot/config-4.3.0 .</span></code></pre></td></tr></table></div></figure>


<p>You might run into problem or two here depending on your CHIP Linux configuration. One, you may not have a root password! You might need to set that. Secondly, you might not have configured sshd to allow root login. Be sure you&rsquo;ve remedied both of these issues as we&rsquo;ll use root login throughout the kernel build process.</p>

<h2>- Configuring the kernel</h2>

<p>To configure our kernel, we simply invoke the makefile with the following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>make ARCH=arm CROSS_COMPILE=/usr/bin/arm-linux-gnueabihf- menuconfig</span></code></pre></td></tr></table></div></figure>


<p>This will bring up an easy to use menu-driven application that allows you to select or delete items that you wish to have in your kernel.</p>

<p>Remember that config file that we copied over from the CHIP? Let&rsquo;s load that as our starting point.</p>

<p>Now make the modifications that you wish to your kernel. In this kernel, I want to add ppp support as well as ppp async-serial support. I select both of those, and then save my configuration file as <code>.config</code>.</p>

<p>Before we actually save the configuration, it&rsquo;s a good idea to mark your Kernel so you can easily verify you&rsquo;re running the kernel that you built. To do that we add a <code>Local Version</code> marking to the kernel release. Under the following Menu item:
- General setup
- ( ) Local version - append to kernel release</p>

<p>Add a tag that marks your kernel. I use <code>rb-2016-08-01.0</code> for example.</p>

<p>Now I&rsquo;m ready to actually compile the kernel that represents the configuration that I just selected. To do so, simply run <code>make</code> as follows:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>make ARCH=arm CROSS_COMPILE=/usr/bin/arm-linux-gnueabihf- -j n</span></code></pre></td></tr></table></div></figure>


<p>where <code>n</code> is the number of cores that you have on your box.</p>

<p>Once the compilation successfully completes, you&rsquo;ll next need to install the modules into a directory that we&rsquo;ll use later to place them onto the CHIP.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mkdir /tmp/lib
</span><span class='line'>make ARCH=arm CROSS_COMPILE=/usr/bin/arm-linux-gnueabihf- INSTALL_MOD_PATH=/tmp/lib modules_install</span></code></pre></td></tr></table></div></figure>


<p>Add the <code>RTL8723BS</code>: This is not part of the CHIP-linux source tree.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd /home/vagrant/CHIP-linux
</span><span class='line'>git clone https://github.com/NextThingCo/RTL8723BS.git</span></code></pre></td></tr></table></div></figure>


<p>And build it&hellip;</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd RTL8723BS
</span><span class='line'>
</span><span class='line'>## Check out the Debian branch...
</span><span class='line'>git checkout -b debian origin/debian
</span><span class='line'>
</span><span class='line'>## Patch it...
</span><span class='line'>for i in debian/patches/0*; do  echo $i; patch -p 1 &lt;$i ; done
</span><span class='line'>
</span><span class='line'>## build it...
</span><span class='line'>make -j 8 CONFIG_PLATFORM_ARM_SUNxI=y ARCH=arm CROSS_COMPILE=/usr/bin/arm-linux-gnueabihf- -C /home/vagrant/CHIP-linux/ M=$PWD CONFIG_RTL8723BS=m  INSTALL_MOD_PATH=/tmp/lib
</span><span class='line'>make -j 8 CONFIG_PLATFORM_ARM_SUNxI=y ARCH=arm CROSS_COMPILE=/usr/bin/arm-linux-gnueabihf- -C /home/vagrant/CHIP-linux/ M=$PWD CONFIG_RTL8723BS=m  INSTALL_MOD_PATH=/tmp/lib modules_install</span></code></pre></td></tr></table></div></figure>


<p>Now that everything is compiled and built, you&rsquo;re ready to copy it to your CHIP!</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>scp /home/vagrant/CHIP-linux/arch/arm/boot/zImage root@chip.local:/boot/vmlinuz-4.3.0rb-2016-08-01.1+
</span><span class='line'>scp /home/vagrant/CHIP-linux/.config root@chip.local:/boot/config-4.3.0rb-2016-08-01.1+
</span><span class='line'>scp /home/vagrant/CHIP-linux/System.map root@chip.local:/boot/System.map-4.3.0rb-2016-08-01.1+
</span><span class='line'>cd /tmp/lib/lib/modules
</span><span class='line'>tar cf - 4.3.0rb-2016-08-01.1+ | ssh root@chip.local 'cd /lib/modules; tar xf -'
</span><span class='line'>cd ../firmware/
</span><span class='line'>tar cf - . | ssh root@chip.local 'mkdir /lib/firmware/4.3.0rb-2016-08-01.1+; cd /lib/firmware/4.3.0rd235+; tar xf -'</span></code></pre></td></tr></table></div></figure>


<p>Now to boot your new kernel, there are two choices.</p>

<h4>The Easy Choice:</h4>

<p>Simply copy the existing kernel so you have a backup</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo cp /boot/zImage /boot/zImage.backup
</span><span class='line'>sudo cp /boot/vmlinuz-4.3.0rb-2016-08-01.1 /boot/zImage</span></code></pre></td></tr></table></div></figure>


<p>Should something go wrong with the new kernel and you can&rsquo;t boot, you&rsquo;re hosed. There&rsquo;s another way.</p>

<h4>The Complicated, But More Better for Ya Choice:</h4>

<p>The more complicated, but far more flexible approach is to add a serial USB-to-Serial connector to the chip. You can use a PL2303 and connect it as follows:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PL2303 TX (white wire)      -&gt; CHIP Pin 3
</span><span class='line'>PL2303 RX (grey wire)       -&gt; CHIP Pin 5
</span><span class='line'>PL2303 Gnd (black wire)     -&gt; CHIP Pin 1</span></code></pre></td></tr></table></div></figure>


<p>And on your computer use <code>screen</code> to access the serial port:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>screen /dev/ttyUSB0 115200</span></code></pre></td></tr></table></div></figure>


<p>Keep in mind that the actual device name may change depending on what OS you are using. I use the linux device name. Also, pay attention to the digit at the end, it might be some number other than zero.</p>

<p>Before you connect the serial port, be sure to first copy the orgiginal kernel so you have a backup. And then shut down the CHIP before you connect the serial cable.</p>

<p>Once all connected (both litreally with the USB connector as well as the screen command), type a key to stop the U-Boot booting process and fall into a u-boot shell.</p>

<p>Now you can change the <code>bootcmd</code> and boot the kernel that you copied to the CHIP in the previous section. In this case, if there is a problem booting your new kernel, you can easily boot the backup kernel instead.</p>

<p>Wah Lah! You have successfully booted your new kernel!</p>

<p>If everything went as expected, you should be able to now connect your FONA 2g or 3g Cellular GSM breakout to a PL2303 and connect it to your CHIP. Be sure to use a lipo battery as well as a USB power source for your FONA. Turn it on, and verify that you can access the device.</p>

<p>Here again, I use <code>screen /dev/ttyUSB0</code> to access the FONA. Verify that the PL2303 is accessable to the CHIP via <code>lsusb</code> and you should see the PL2303 signature. If you don&rsquo;t see it, you likely didn&rsquo;t configure your kernel properly to include the USB device.</p>

<p>But if you did read the directions carefully, and have the device, and are able to <code>screen</code> to it, you should be able to communicate with the FONA by sending it <code>AT</code> commands, and receive back from the FONA a response, like <code>OK</code>.</p>

<p>Make sure you&rsquo;ve added the <code>ppp</code> package.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo apt-get update
</span><span class='line'>sudo apt-get install ppp</span></code></pre></td></tr></table></div></figure>


<p>If all&rsquo;s connected, and you&rsquo;ve successfully added the <code>ppp</code> package, you can now configure the ppp setup.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo -i
</span><span class='line'>cd /etc/ppp/peers/
</span><span class='line'>wget https://raw.githubusercontent.com/adafruit/FONA_PPP/master/fona</span></code></pre></td></tr></table></div></figure>


<p>Now edit the file and change the <code>MUST CHANGE</code> items. There are essentialy two of them</p>

<ul>
<li><p>The first one is the APN. In my case I am using <a href="https://ting.com/?lpn=zs3fff5o1tf">Ting Wireless</a>. The APN is <code>wholesale</code></p></li>
<li><p>The second item to change is the serial device. Make sure the device name that is connected to the FONA is specified in the file. For example, <code>/dev/ttyUSB0</code>.</p></li>
</ul>


<p>Save the file, and give it a go! To turn on and off ppp, use <code>pon`` and</code>poff&#8220;` respectivly.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo pon fona</span></code></pre></td></tr></table></div></figure>


<p>You can verify that it worked by looking for the interface. A successful ppp session will result in a device shown when you run <code>ifconfig</code>. If you run into problems, take a look at the log files for details on what went wrong. Common problems include forgetting to turn on the FONA device!</p>

<p>take a look at the ppp chat script in the syslog file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat /var/log/syslog | grep chat</span></code></pre></td></tr></table></div></figure>


<p>If you successfully create your ppp connection and have verified it via <code>ifconfig</code>, try it out! simply ping a website of your choice.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ping yahoo.com</span></code></pre></td></tr></table></div></figure>


<p>To get a feel for the speed of the connection, grab some data too:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wget www.yahoo.com</span></code></pre></td></tr></table></div></figure>


<p>Once you&rsquo;re done with your ppp connection, simply turn it off:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo poff fona</span></code></pre></td></tr></table></div></figure>


<h2>GPS</h2>

<p>Now that you have your FONA and your kernel in order, you can get the GPS setup. Start off by adding the following packages:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo apt install gpsd gpsd-clients python-gps</span></code></pre></td></tr></table></div></figure>


<p>To start the GPS software, first stop the systemd gps services.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo systemctl stop gpsd.socket
</span><span class='line'>sudo systemctl disable gpsd.socket</span></code></pre></td></tr></table></div></figure>


<p>And now start the gpsd daemon</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo gpsd /dev/ttyUSB0 -F /var/run/gpsd.sock</span></code></pre></td></tr></table></div></figure>


<p>Use the <code>cgps</code> command to run the GPS data viewer. Or for a more detailed data view, run <code>gpsmon</code></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/02/05/open-weather-api-and-golang/">Open Weather API and Golang</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-02-05T12:40:06-05:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>5</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>12:40 pm</span></time>
        
           | <a href="/blog/2016/02/05/open-weather-api-and-golang/#disqus_thread"
             data-disqus-identifier="http://rabarar.github.io/blog/2016/02/05/open-weather-api-and-golang/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Weather API</h2>

<p>Today I tripped over the <a href="http://http://openweathermap.org">OpenWeatherMap</a> and created an account to see what type of weather information I can get from the <a href="http://openweathermap.org/api">published api</a>. Cool stuff.</p>

<p>I thought I&rsquo;d write a quick little golang program to extract the json data and turn it into something that I could send to say(1), and then pump that through darkice(1) and icecast(1) on a raspberry pi! A talking weather station of sorts.</p>

<p>Here&rsquo;s the code:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="kn">package</span> <span class="nx">main</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="p">(</span>
</span><span class='line'>        <span class="s">&quot;encoding/json&quot;</span>
</span><span class='line'>        <span class="s">&quot;fmt&quot;</span>
</span><span class='line'>        <span class="s">&quot;io/ioutil&quot;</span>
</span><span class='line'>        <span class="s">&quot;log&quot;</span>
</span><span class='line'>        <span class="s">&quot;net/http&quot;</span>
</span><span class='line'>        <span class="s">&quot;net/url&quot;</span>
</span><span class='line'>        <span class="s">&quot;strings&quot;</span>
</span><span class='line'>        <span class="s">&quot;time&quot;</span>
</span><span class='line'><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="kd">const</span> <span class="p">(</span>
</span><span class='line'>        <span class="nx">dumpRaw</span> <span class="p">=</span> <span class="kc">false</span>
</span><span class='line'>        <span class="nx">zip</span>     <span class="p">=</span> <span class="s">&quot;21045,us&quot;</span>
</span><span class='line'>        <span class="nx">api</span>     <span class="p">=</span> <span class="s">&quot;XXXXXXXXXXXXXXXXXXXXXXXXXX&quot;</span>
</span><span class='line'><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="p">(</span>
</span><span class='line'>        <span class="nx">weatherKeys</span> <span class="p">=</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">bool</span><span class="p">{</span><span class="s">&quot;main&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="s">&quot;wind&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="s">&quot;coord&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="s">&quot;weather&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="s">&quot;sys&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="s">&quot;clouds&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">}</span>
</span><span class='line'><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">urlString</span> <span class="o">:=</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;http://api.openweathermap.org/data/2.5/weather?zip=%s&amp;APPID=%s&quot;</span><span class="p">,</span> <span class="nx">zip</span><span class="p">,</span> <span class="nx">api</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">u</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">url</span><span class="p">.</span><span class="nx">Parse</span><span class="p">(</span><span class="nx">urlString</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">res</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">String</span><span class="p">())</span>
</span><span class='line'>        <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">jsonBlob</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">ioutil</span><span class="p">.</span><span class="nx">ReadAll</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">Body</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">res</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nx">Close</span><span class="p">()</span>
</span><span class='line'>        <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">data</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="nx">dumpRaw</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;blob = %s\n\n&quot;</span><span class="p">,</span> <span class="nx">jsonBlob</span><span class="p">)</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="nx">err</span> <span class="p">=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">Unmarshal</span><span class="p">(</span><span class="nx">jsonBlob</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">data</span><span class="p">)</span>
</span><span class='line'>        <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;error:&quot;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="nx">dumpRaw</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;%+v&quot;</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="k">for</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">v</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">data</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">val</span><span class="p">,</span> <span class="nx">isAnArray</span> <span class="o">:=</span> <span class="nx">isKey</span><span class="p">(</span><span class="nx">k</span><span class="p">)</span>
</span><span class='line'>                <span class="k">if</span> <span class="nx">val</span> <span class="p">{</span>
</span><span class='line'>                        <span class="nx">dumpMap</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span> <span class="nx">v</span><span class="p">,</span> <span class="nx">isAnArray</span><span class="p">)</span>
</span><span class='line'>                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">dumpMap</span><span class="p">(</span><span class="nx">k</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">v</span> <span class="kd">interface</span><span class="p">{},</span> <span class="nx">isArray</span> <span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;%s:\n&quot;</span><span class="p">,</span> <span class="nx">k</span><span class="p">)</span>
</span><span class='line'>        <span class="k">if</span> <span class="nx">isArray</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="nx">v</span><span class="p">.([]</span><span class="kd">interface</span><span class="p">{}));</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
</span><span class='line'>                        <span class="nx">nmap</span> <span class="o">:=</span> <span class="nx">v</span><span class="p">.([]</span><span class="kd">interface</span><span class="p">{})[</span><span class="nx">i</span><span class="p">].(</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{})</span>
</span><span class='line'>                        <span class="k">for</span> <span class="nx">kk</span><span class="p">,</span> <span class="nx">vv</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">nmap</span> <span class="p">{</span>
</span><span class='line'>                                <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;\tthe %s is %v\n&quot;</span><span class="p">,</span> <span class="nx">kk</span><span class="p">,</span> <span class="nx">vv</span><span class="p">)</span>
</span><span class='line'>                        <span class="p">}</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">nmap</span> <span class="o">:=</span> <span class="nx">v</span><span class="p">.(</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{})</span>
</span><span class='line'>                <span class="k">for</span> <span class="nx">kk</span><span class="p">,</span> <span class="nx">vv</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">nmap</span> <span class="p">{</span>
</span><span class='line'>                        <span class="k">if</span> <span class="nx">isTempVal</span><span class="p">(</span><span class="nx">kk</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                                <span class="nx">farenTemp</span> <span class="o">:=</span> <span class="nx">faren</span><span class="p">(</span><span class="nx">vv</span><span class="p">.(</span><span class="kt">float64</span><span class="p">))</span>
</span><span class='line'>                                <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;\tthe %s is %f\n&quot;</span><span class="p">,</span> <span class="nx">kk</span><span class="p">,</span> <span class="nx">farenTemp</span><span class="p">)</span>
</span><span class='line'>                        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="nx">isSunVal</span><span class="p">(</span><span class="nx">kk</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                                <span class="nx">sunTime</span> <span class="o">:=</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Unix</span><span class="p">((</span><span class="nb">int64</span><span class="p">(</span><span class="nx">vv</span><span class="p">.(</span><span class="kt">float64</span><span class="p">))),</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>                                <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;\tthe %s at %v\n&quot;</span><span class="p">,</span> <span class="nx">kk</span><span class="p">,</span> <span class="nx">sunTime</span><span class="p">)</span>
</span><span class='line'>                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                                <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;\tthe %s is %v\n&quot;</span><span class="p">,</span> <span class="nx">kk</span><span class="p">,</span> <span class="nx">vv</span><span class="p">)</span>
</span><span class='line'>                        <span class="p">}</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">isKey</span><span class="p">(</span><span class="nx">k</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">ok</span> <span class="kt">bool</span><span class="p">,</span> <span class="nx">isArray</span> <span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">isArray</span><span class="p">,</span> <span class="nx">ok</span> <span class="p">=</span> <span class="nx">weatherKeys</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">ok</span><span class="p">,</span> <span class="nx">isArray</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">faren</span><span class="p">(</span><span class="nx">kelvin</span> <span class="kt">float64</span><span class="p">)</span> <span class="kt">float64</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="p">(</span><span class="mf">9.0</span><span class="o">/</span><span class="mf">5.0</span><span class="o">*</span><span class="p">(</span><span class="nx">kelvin</span><span class="o">-</span><span class="mf">273.0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">32.0</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">isTempVal</span><span class="p">(</span><span class="nx">k</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">bool</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">Contains</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span> <span class="s">&quot;temp&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">isSunVal</span><span class="p">(</span><span class="nx">k</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">bool</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">Contains</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span> <span class="s">&quot;sun&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>So what&rsquo;s it do??</h2>

<p>The given a zipcode, and an API Key, output generates something like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>main:
</span><span class='line'>  the humidity is 83
</span><span class='line'>  the temp_min is 38.962400
</span><span class='line'>  the temp_max is 38.962400
</span><span class='line'>  the sea_level is 1038.13
</span><span class='line'>  the grnd_level is 1031.23
</span><span class='line'>  the temp is 38.962400
</span><span class='line'>  the pressure is 1031.23
</span><span class='line'>wind:
</span><span class='line'>  the speed is 6.26
</span><span class='line'>  the deg is 319.504
</span><span class='line'>clouds:
</span><span class='line'>  the all is 32
</span><span class='line'>sys:
</span><span class='line'>  the message is 0.0066
</span><span class='line'>  the country is US
</span><span class='line'>  the sunrise at 2016-02-05 07:10:10 -0500 EST
</span><span class='line'>  the sunset at 2016-02-05 17:33:06 -0500 EST
</span><span class='line'>coord:
</span><span class='line'>  the lon is -76.84
</span><span class='line'>  the lat is 39.24
</span><span class='line'>weather:
</span><span class='line'>  the description is scattered clouds
</span><span class='line'>  the icon is 03d
</span><span class='line'>  the id is 802
</span><span class='line'>  the main is Clouds</span></code></pre></td></tr></table></div></figure>


<p>Just a start&hellip; check out other API calls too&hellip;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/09/29/cgo-and-destructors-for-managing-allocated-memory-in-go/">Cgo and Destructors for Managing Allocated Memory in Go</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-09-29T12:55:59-04:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>12:55 pm</span></time>
        
           | <a href="/blog/2015/09/29/cgo-and-destructors-for-managing-allocated-memory-in-go/#disqus_thread"
             data-disqus-identifier="http://rabarar.github.io/blog/2015/09/29/cgo-and-destructors-for-managing-allocated-memory-in-go/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Managing memory allocation when using Cgo</h2>

<p>A common challenge when creating Cgo and Golang code that needs to manage dynamically created objects is memory management. How do you create an objet and <strong>ensure</strong> that the object isn&rsquo;t leaked. The garbage collector will help manage natural native golang objects that are no longer needed once the scope is exited. But how can we do the same thing when we create dynamic memory objects with Cgo?</p>

<p>Turns out the answer lives at the intersection of <code>runtime.SetFinalizer()</code> and <code>runtime.CG()</code> and a wrapping up the objects in a golang struct.</p>

<p>Here&rsquo;s an example of a golang program that allocates memory in C, and then frees it with a call to the finalizer:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="kn">package</span> <span class="nx">main</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/*</span>
</span><span class='line'>
</span><span class='line'><span class="cm">#include &lt;stdlib.h&gt;</span>
</span><span class='line'><span class="cm">#include &lt;stdio.h&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="cm">void *foo(void) {</span>
</span><span class='line'><span class="cm">        static int count= 0;</span>
</span><span class='line'><span class="cm">        void *thing = (void *)malloc(sizeof(int));</span>
</span><span class='line'><span class="cm">        *((int *)thing) = count++;</span>
</span><span class='line'><span class="cm">        return thing;</span>
</span><span class='line'><span class="cm">}</span>
</span><span class='line'>
</span><span class='line'><span class="cm">*/</span>
</span><span class='line'><span class="kn">import</span> <span class="s">&quot;C&quot;</span>
</span><span class='line'><span class="kn">import</span> <span class="p">(</span>
</span><span class='line'>        <span class="s">&quot;fmt&quot;</span>
</span><span class='line'>        <span class="s">&quot;runtime&quot;</span>
</span><span class='line'>        <span class="s">&quot;sync&quot;</span>
</span><span class='line'>        <span class="s">&quot;time&quot;</span>
</span><span class='line'>        <span class="s">&quot;unsafe&quot;</span>
</span><span class='line'><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="kd">type</span> <span class="nx">CFoo</span> <span class="kd">struct</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">sync</span><span class="p">.</span><span class="nx">Mutex</span>
</span><span class='line'>        <span class="nx">name</span>     <span class="kt">string</span>
</span><span class='line'>        <span class="nx">allocCnt</span> <span class="kt">int</span>
</span><span class='line'>        <span class="nx">memory</span>   <span class="nx">unsafe</span><span class="p">.</span><span class="nx">Pointer</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">CFoo</span><span class="p">)</span> <span class="nx">alloc</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">c</span><span class="p">.</span><span class="nx">name</span> <span class="p">=</span> <span class="nx">name</span>
</span><span class='line'>        <span class="nx">c</span><span class="p">.</span><span class="nx">Lock</span><span class="p">()</span>
</span><span class='line'>        <span class="k">defer</span> <span class="nx">c</span><span class="p">.</span><span class="nx">Unlock</span><span class="p">()</span>
</span><span class='line'>        <span class="nx">c</span><span class="p">.</span><span class="nx">allocCnt</span><span class="o">++</span>
</span><span class='line'>        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;alloc[%s]: count = %d\n&quot;</span><span class="p">,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">allocCnt</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">c</span><span class="p">.</span><span class="nx">memory</span> <span class="p">=</span> <span class="nx">C</span><span class="p">.</span><span class="nx">foo</span><span class="p">()</span>
</span><span class='line'>        <span class="nx">runtime</span><span class="p">.</span><span class="nx">SetFinalizer</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="nx">free</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">free</span><span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">CFoo</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">C</span><span class="p">.</span><span class="nx">free</span><span class="p">(</span><span class="nx">unsafe</span><span class="p">.</span><span class="nx">Pointer</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">memory</span><span class="p">))</span>
</span><span class='line'>        <span class="nx">c</span><span class="p">.</span><span class="nx">Lock</span><span class="p">()</span>
</span><span class='line'>        <span class="k">defer</span> <span class="nx">c</span><span class="p">.</span><span class="nx">Unlock</span><span class="p">()</span>
</span><span class='line'>        <span class="nx">c</span><span class="p">.</span><span class="nx">allocCnt</span><span class="o">--</span>
</span><span class='line'>        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;free[%s]: count = %d\n&quot;</span><span class="p">,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">allocCnt</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">Bar</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">c1</span><span class="p">,</span> <span class="nx">c2</span> <span class="nx">CFoo</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">c1</span><span class="p">.</span><span class="nx">alloc</span><span class="p">(</span><span class="s">&quot;cfoo&quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">c2</span><span class="p">.</span><span class="nx">alloc</span><span class="p">(</span><span class="s">&quot;cbar&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">Bar</span><span class="p">()</span>
</span><span class='line'>                <span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span>
</span><span class='line'>                <span class="c1">//runtime.GC()</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="nx">runtime</span><span class="p">.</span><span class="nx">GC</span><span class="p">()</span>
</span><span class='line'>        <span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;done.&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>So what&rsquo;s going on here? First we create a struct that will contain our dynmaically allocated memory, <strong>CFoo</strong>. Inside of <strong>CFoo</strong> I threw in a Mutex, a <strong>name</strong>, a <strong>allocCnt</strong> to allow us to track the allocations and releases of the memory, and lastly <strong>memory</strong> of type <code>unsafe.Pointer</code> that will point to our dnyamically allocated object. The mutex and the count are soley illustrative and aren&rsquo;t likely needed in practice.</p>

<p>Our <strong>CFoo</strong> struct contains a function <code>alloc</code> that will do two important things:</p>

<ul>
<li>First it will allocated the memory via Cgo</li>
<li>Next it will register the finalizer so that the memoy will be freed when the object leaves scope.</li>
</ul>


<p>When we create the memory we assign it to our struct member. The object <strong>CFoo</strong> will exist until the context is no longer valid. And when it&rsquo;s invalid, the finalizer will be called <strong>when the garbage collector is invoked</strong>.</p>

<p>the <code>`free(c *CFoo)</code> function will take our <strong>CFoo</strong> and call the cgo <code>free()</code> to release the memory.</p>

<p>It&rsquo;s that simple!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/09/22/jetson-tk-1-nvidia-l4t-linux-platform/">Jetson TK-1 Nvidia L4T Linux Platform</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-09-22T13:44:06-04:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2015</span></span> <span class='time'>1:44 pm</span></time>
        
           | <a href="/blog/2015/09/22/jetson-tk-1-nvidia-l4t-linux-platform/#disqus_thread"
             data-disqus-identifier="http://rabarar.github.io/blog/2015/09/22/jetson-tk-1-nvidia-l4t-linux-platform/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Jetson TK-1 - Embedded SBC SuperComputer Power for Pennies</h2>

<p><img src="http://jetsonhacks.com/wp-content/uploads/2014/06/DevBoard2-300x199.png" title="Jetson TK-1" alt="jetsonhacks" /></p>

<p>Okay, so everyone has a blast playing with the &lt; $50 raspberry pi, but what if you take it up a notch. I mean drop a few extra bucks (more like $160 extra) and you can have some serious power in a small little footprint. The Jetson TK-1 is a Kepler GPU with <strong>192 cuda cores</strong> and <strong>4-Plus-1 quad-core ARM Cortex A15 CPU</strong>. That&rsquo;s a lotta power for $192 (retail). But wait, there&rsquo;s more. It comes with 1Ge ethernet connector, 2Gb ram, 16Gb eMMC memory, USB, Audio, SATA, HDMI, and RS-232 serial port (old school).</p>

<p>The board supports a derivative of ubuntu 14.04 called <a href="https://developer.nvidia.com/embedded/linux-tegra">L4T</a>. Additionally, there is support for Cuda 6.5, OpenCV, and OpenGL, as well as samples - <a href="https://developer.nvidia.com/gameworks-opengl-samples">NVIDIA GameWorks OpenGL Samples 2.11</a>. Definitely checkout the floating <a href="http://docs.nvidia.com/gameworks/index.html#gameworkslibrary/graphicssamples/opengl_samples/hdrsample.htm">Teapot!</a>.</p>

<p>Aside from all the graphic power offered by this platform. You can use it as a streaming server too. Real-time mp3 streaming is easy as pi! Er, easy as <strong>Jetson</strong>!!</p>

<h2>Darkice &amp; Icecast2</h2>

<p>I thought I&rsquo;d see how easy it was to setup Darkice and stream live audio from the mic on the Tegra to my Icecast2 server.</p>

<p>To build the source we first need to install all the dependencies:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo apt-get --no-install-recommends install build-essential devscripts autotools-dev fakeroot dpkg-dev debhelper autotools-dev dh-make quilt ccache libsamplerate0-dev libpulse-dev libaudio-dev lame libjack-jackd2-dev libasound2-dev libtwolame-dev libfaad-dev libflac-dev libmp4v2-dev libshout3-dev libmp3lame-dev</span></code></pre></td></tr></table></div></figure>


<p>It took less than a 5 minutes to get it set up! Download the Darkice source and build (configure) it with the <code>--with-alsa and --with-alsa-prefix</code>, and <code>--with-lame, and --with-lame-prefix</code>, both pointing to the library directory for the shared libraries respectivly. After configuring and Making the darkice binary, you&rsquo;ll need to setup a <code>/etc/darkice.cfg</code> file.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># see the darkice.cfg man page for details
</span><span class='line'>
</span><span class='line'># this section describes general aspects of the live streaming session
</span><span class='line'>[general]
</span><span class='line'>duration      = 0                # duration of encoding, in seconds. 0 means forever
</span><span class='line'>bufferSecs    = 5                # size of internal slip buffer, in seconds
</span><span class='line'>reconnect     = yes              # reconnect to the server(s) if disconnected
</span><span class='line'>
</span><span class='line'># this section describes the audio input that will be streamed
</span><span class='line'>[input]
</span><span class='line'>device        = hw:1,0           # Alsa soundcard device for the audio input
</span><span class='line'>sampleRate    = 44100            # sample rate in Hz. try 11025, 22050 or 44100
</span><span class='line'>bitsPerSample = 16               # bits per sample. try 16
</span><span class='line'>channel       = 1                # channels. 1 = mono, 2 = stereo
</span><span class='line'>
</span><span class='line'># this section describes a streaming connection to an IceCast2 server
</span><span class='line'># there may be up to 8 of these sections, named [icecast2-0] ... [icecast2-7]
</span><span class='line'># these can be mixed with [icecast-x] and [shoutcast-x] sections
</span><span class='line'>[icecast2-0]
</span><span class='line'>bitrateMode   = vbr              # variable bit rate
</span><span class='line'>format        = mp3              # format of the stream: mp3
</span><span class='line'>quality       = 0.6              # quality of the stream sent to the server
</span><span class='line'>server        = localhost        # host name of the server
</span><span class='line'>port          = 8000             # port of the IceCast2 server, usually 8000
</span><span class='line'>password      = SOURCE_PASSWORD  # source password to the IceCast2 server
</span><span class='line'>mountPoint    = raspi         # mount point of this stream on the IceCast2 server
</span><span class='line'>name          = RasPi            # name of the stream
</span><span class='line'>description   = DarkIce on RasPi # description of the stream
</span><span class='line'>url           = http://localhost # URL related to the stream
</span><span class='line'>genre         = my genre         # genre of the stream
</span><span class='line'>public        = no               # advertise this stream?
</span><span class='line'>localDumpFile = recording.mp3    # Record also to a file</span></code></pre></td></tr></table></div></figure>


<p> I set the device name to <code>pulse</code>. Fire it up and throw it in the background and you should see a stream registered on your Icecast2 server!</p>

<p> You may need to setup your audio port on the Jetson.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>amixer cset name="Stereo ADC MIXL ADC2 Switch" 0
</span><span class='line'>amixer cset name="Stereo ADC MIXR ADC2 Switch" 0
</span><span class='line'>amixer cset name="Int Mic Switch" 0
</span><span class='line'>amixer cset name="ADC Capture Switch" 1
</span><span class='line'>amixer cset name="RECMIXL BST1 Switch" 0
</span><span class='line'>amixer cset name="RECMIXR BST1 Switch" 0
</span><span class='line'>amixer cset name="RECMIXL BST2 Switch" 1
</span><span class='line'>amixer cset name="RECMIXR BST2 Switch" 1
</span><span class='line'>amixer cset name="Stereo ADC L1 Mux" "ADC"
</span><span class='line'>amixer cset name="Stereo ADC R1 Mux" "ADC"
</span><span class='line'>amixer cset name="Stereo ADC MIXL ADC1 Switch" 1
</span><span class='line'>amixer cset name="Stereo ADC MIXR ADC1 Switch" 1
</span><span class='line'>amixer cset name="Stereo ADC MIXL ADC2 Switch" 0
</span><span class='line'>amixer cset name="Stereo ADC MIXR ADC2 Switch" 0
</span><span class='line'>amixer cset name="IN1 Mode Control" "Single ended"
</span><span class='line'>amixer cset name="IN2 Mode Control" "Single ended"
</span><span class='line'>amixer cset name="Mic Jack Switch" 1</span></code></pre></td></tr></table></div></figure>


<p>and then save the settings using:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>alsactl store</span></code></pre></td></tr></table></div></figure>


<p> It&rsquo;s that easy!</p>

<p> Helpful links:</p>

<ul>
<li><a href="http://elinux.org/Jetson_TK1">eLinux Tegra</a></li>
<li><a href="http://jetsonhacks.com">Jetson Hacks!</a></li>
<li><a href="https://developer.nvidia.com/jetson-tk1">nVidia Developer for Jetson</a></li>
<li><a href="http://arrayfire.com/download/">Tegra K1 ArrayFire</a></li>
</ul>


<p> #### Next Up: Jetson TK-1 20-node cluster
 So, I was impulsive&hellip; I bought 20 of these boards, loaded up the <a href="https://docs.nvidia.com/jetpack-tk1/index.html">JetPack</a> and started to ponder - how I am going to power, connect, and house 20 of these boards.</p>

<p> Aside from stacking up the hardware, I&rsquo;m thinking about the software to glue twenty of these things together too. Want to take advantage of cuda and maybe even mpi&hellip; stay tuned!!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/08/17/golang-on-golang/">Golang on Golang</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-08-17T10:41:00-04:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>17</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>10:41 am</span></time>
        
           | <a href="/blog/2015/08/17/golang-on-golang/#disqus_thread"
             data-disqus-identifier="http://rabarar.github.io/blog/2015/08/17/golang-on-golang/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Golang packages &ldquo;go/parser&rdquo; and &ldquo;go/ast&rdquo;</h3>

<h5>Golang Parsing Golang:</h5>

<p>Included as part of the built-in golang packages are libraries that provide for programatic parsing and inspecting of golang source code.</p>

<p>The two key packages are <code>go/parser</code> and <code>go/ast</code></p>

<p>Let&rsquo;s take a look Parsing process. To start, we must create an Abstract Syntax Tree (AST). Next, we can Parse a source file (or string), which upon success returns a pointer to and AST, <code>*ast.File</code>. All the meat is inside the <code>ast.File</code></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="c1">// Create the AST by parsing src.</span>
</span><span class='line'><span class="nx">fset</span> <span class="o">:=</span> <span class="nx">token</span><span class="p">.</span><span class="nx">NewFileSet</span><span class="p">()</span> <span class="c1">// positions are relative to fset</span>
</span><span class='line'><span class="nx">f</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">parser</span><span class="p">.</span><span class="nx">ParseFile</span><span class="p">(</span><span class="nx">fset</span><span class="p">,</span> <span class="s">&quot;src.go&quot;</span><span class="p">,</span> <span class="nx">src</span><span class="p">,</span> <span class="nx">parser</span><span class="p">.</span><span class="nx">ParseComments</span><span class="p">)</span>
</span><span class='line'><span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span><span class='line'>        <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now we can look at different aspects within the parse. For example, if we want to see what imports are included in the source file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="c1">// Print the imports from the file&#39;s AST.</span>
</span><span class='line'>  <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">s</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">f</span><span class="p">.</span><span class="nx">Imports</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">Path</span><span class="p">.</span><span class="nx">Value</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Lots of opportunities to parse through and look for declarations, functions, specific language mechanisms, expressions, etc. The opportunities are virtually limitless!</p>

<p>There&rsquo;s a ton of reflection at play in this package. You&rsquo;ll need to inspect and assert to look at the specific elements within a structure. A close read of the AST Print is a worthwhile exercise :)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/07/07/golang-scribbles/">Golang Scribbles</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-07-07T11:05:41-04:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>11:05 am</span></time>
        
           | <a href="/blog/2015/07/07/golang-scribbles/#disqus_thread"
             data-disqus-identifier="http://rabarar.github.io/blog/2015/07/07/golang-scribbles/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>So I was <a href="http://bored.com"><strong>bored</strong></a> an thought I&rsquo;d write some go code to demonstrate a few interesting features in Go!</p>

<p>Take a look at</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="kn">package</span> <span class="nx">main</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="p">(</span>
</span><span class='line'>        <span class="s">&quot;fmt&quot;</span>
</span><span class='line'>        <span class="s">&quot;sync&quot;</span>
</span><span class='line'>        <span class="s">&quot;time&quot;</span>
</span><span class='line'><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="kd">const</span> <span class="p">(</span>
</span><span class='line'>        <span class="nx">MAXFUNCS</span> <span class="p">=</span> <span class="mi">100</span>
</span><span class='line'><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">x</span> <span class="kd">struct</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">sync</span><span class="p">.</span><span class="nx">Mutex</span>
</span><span class='line'>                <span class="nx">y</span> <span class="kd">func</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="kt">int</span>
</span><span class='line'>                <span class="nx">z</span> <span class="kt">int</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">xx</span> <span class="p">=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kd">struct</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">sync</span><span class="p">.</span><span class="nx">Mutex</span>
</span><span class='line'>                <span class="nx">y</span> <span class="kd">func</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="kt">int</span>
</span><span class='line'>                <span class="nx">z</span> <span class="kt">int</span>
</span><span class='line'>        <span class="p">})</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="nx">MAXFUNCS</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">go</span> <span class="kd">func</span><span class="p">(</span><span class="nx">num</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                        <span class="nx">x</span><span class="p">.</span><span class="nx">Lock</span><span class="p">()</span>
</span><span class='line'>                        <span class="nx">x</span><span class="p">.</span><span class="nx">y</span> <span class="p">=</span> <span class="nx">z</span>
</span><span class='line'>                        <span class="nx">x</span><span class="p">.</span><span class="nx">z</span> <span class="p">=</span> <span class="nx">x</span><span class="p">.</span><span class="nx">y</span><span class="p">(</span><span class="mi">42</span> <span class="o">*</span> <span class="nx">num</span><span class="p">)</span>
</span><span class='line'>                        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;x.z = %d\n&quot;</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">z</span><span class="p">)</span>
</span><span class='line'>                        <span class="nx">xx</span> <span class="o">&lt;-</span> <span class="nx">x</span>
</span><span class='line'>                        <span class="nx">x</span><span class="p">.</span><span class="nx">Unlock</span><span class="p">()</span>
</span><span class='line'>                <span class="p">}(</span><span class="nx">i</span><span class="p">)</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">to</span> <span class="o">:=</span> <span class="mi">0</span>
</span><span class='line'>        <span class="nx">gets</span> <span class="o">:=</span> <span class="mi">0</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">for</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">select</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">case</span> <span class="nx">num</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="nx">xx</span><span class="p">:</span>
</span><span class='line'>                        <span class="nx">to</span> <span class="p">=</span> <span class="mi">0</span>
</span><span class='line'>                        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;got %d\n&quot;</span><span class="p">,</span> <span class="nx">num</span><span class="p">.</span><span class="nx">z</span><span class="p">)</span>
</span><span class='line'>                        <span class="nx">gets</span><span class="o">++</span>
</span><span class='line'>                <span class="k">default</span><span class="p">:</span>
</span><span class='line'>                        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;sleeping...\n&quot;</span><span class="p">)</span>
</span><span class='line'>                        <span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span>
</span><span class='line'>                        <span class="nx">to</span><span class="o">++</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>                <span class="k">if</span> <span class="nx">to</span> <span class="p">&gt;</span> <span class="mi">5</span> <span class="p">{</span>
</span><span class='line'>                        <span class="k">break</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;received %d gets before timeout\n&quot;</span><span class="p">,</span> <span class="nx">gets</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">z</span><span class="p">(</span><span class="nx">w</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">w</span> <span class="o">/</span> <span class="mi">2</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here I want to highlight a few cool concepts in Go:</p>

<ul>
<li>Anonymous structures</li>
<li>Bi-directional Channels</li>
<li>Go Routines</li>
<li>Non-blocking Channels</li>
<li>Anonymous fields in structures</li>
<li>Closures</li>
</ul>


<p>This toy program defines a variable <em>x</em> that is an anonymous struct that has an anonymous field that is a <code>sync.Mutux</code>. Why make this field anonymous? Well, by doing so, we can <code>Lock()</code> and <code>Unlock()</code> the structure without needlessly specifying a fieldname. Simply <code>x.Lock()</code> will lock the Mutux.</p>

<p>Next we create a channel of type that&rsquo;s equivalent to the unnamed stucture type. We do this by mirroring the definition of the unnamed structure in the variable definition.</p>

<p>Now that we&rsquo;ve defined our variables, we create a bunch of go routines using a function closure. We define a function that takes an <code>int</code> as our closure. We then <code>Lock()</code> our variable, assign a function to memeber <code>x.y</code> and call the function passing in the integer and returning the result to <code>x.z</code>. Now that we&rsquo;ve assigned values to <code>x</code> we pass it down the channel <code>xx</code>. Lastly we <code>Unlock()</code> the Mutux.</p>

<p>At this point we&rsquo;ve fired up a bunch of go routines, and sent copies of our anonymous struct down the channel.</p>

<p>Next we start and infinite loop (yikes!) and check our channel for results in our main go-routine.</p>

<p>The first <code>case</code> in the <code>select</code> checks to see if we&rsquo;ve received a message on the channel. If we have we print out the value that we assigned to our integer field in our anonymous structure and tally the reeipt of a message on the channel.</p>

<p>If we don&rsquo;t receive a message, we default to our <code>default</code> case where we manage a timeout counter, <code>to</code>, After 5 consecutive seconds of not receiving any messages, we break our infinite loop, and report a timeout and display how many messages we received prior to timing out.</p>

<p>What might make this example more interesting is to delay each go routine by a random amount of time and see if our reception of messages completes prior to receiving all of the messages.</p>

<p>Try modifying the function z as follows and see what happens</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="kd">func</span> <span class="nx">z</span><span class="p">(</span><span class="nx">w</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="p">(</span><span class="nx">rand</span><span class="p">.</span><span class="nx">Intn</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">w</span><span class="o">/</span><span class="mi">2</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This more realistically demonstrates how the Non-blocking channel works when reading mesages at an unpredictable rate.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/07/02/darkice-and-icecast/">DarkIce and IceCast</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-07-02T17:49:49-04:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>2</span><span class='date-suffix'>nd</span>, <span class='date-year'>2015</span></span> <span class='time'>5:49 pm</span></time>
        
           | <a href="/blog/2015/07/02/darkice-and-icecast/#disqus_thread"
             data-disqus-identifier="http://rabarar.github.io/blog/2015/07/02/darkice-and-icecast/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong>So</strong> you want to <em>livestream audio</em> from your Pi to the web? Take a look at these two packages: Darkice, and IceCast. Darkice lets you select a sound input to encode and stream to an IceCast server. The server will wrap the audio stream with a nice web-appropriate display to make selecting and playing content easily.</p>

<hr />

<h2>DarkIce: Audio Encoding software</h2>

<p>First, take a look at this <a href="https://stmllr.net/blog/live-mp3-streaming-from-audio-in-with-darkice-and-icecast2-on-raspberry-pi/">link</a> describing how to compile DarkIce with mp3 support which is likely what you&rsquo;re going to want.</p>

<p>Here&rsquo;s the config file to setup DarkIce on</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># see the darkice.cfg man page for details
</span><span class='line'>
</span><span class='line'># this section describes general aspects of the live streaming session
</span><span class='line'>[general]
</span><span class='line'>duration      = 0                # duration of encoding, in seconds. 0 means forever
</span><span class='line'>bufferSecs    = 5                # size of internal slip buffer, in seconds
</span><span class='line'>reconnect     = yes              # reconnect to the server(s) if disconnected
</span><span class='line'>
</span><span class='line'># this section describes the audio input that will be streamed
</span><span class='line'>[input]
</span><span class='line'>device        = hw:1,0           # Alsa soundcard device for the audio input
</span><span class='line'>sampleRate    = 44100            # sample rate in Hz. try 11025, 22050 or 44100
</span><span class='line'>bitsPerSample = 16               # bits per sample. try 16
</span><span class='line'>channel       = 1                # channels. 1 = mono, 2 = stereo
</span><span class='line'>
</span><span class='line'># this section describes a streaming connection to an IceCast2 server
</span><span class='line'># there may be up to 8 of these sections, named [icecast2-0] ... [icecast2-7]
</span><span class='line'># these can be mixed with [icecast-x] and [shoutcast-x] sections
</span><span class='line'>[icecast2-0]
</span><span class='line'>bitrateMode   = vbr              # variable bit rate
</span><span class='line'>format        = mp3              # format of the stream: mp3
</span><span class='line'>quality       = 0.6              # quality of the stream sent to the server
</span><span class='line'>server        = localhost        # host name of the server
</span><span class='line'>port          = 8000             # port of the IceCast2 server, usually 8000
</span><span class='line'>password      = SOURCE_PASSWORD  # source password to the IceCast2 server
</span><span class='line'>mountPoint    = raspi         # mount point of this stream on the IceCast2 server
</span><span class='line'>name          = RasPi            # name of the stream
</span><span class='line'>description   = DarkIce on RasPi # description of the stream
</span><span class='line'>url           = http://localhost # URL related to the stream
</span><span class='line'>genre         = my genre         # genre of the stream
</span><span class='line'>public        = no               # advertise this stream?
</span><span class='line'>localDumpFile = recording.mp3    # Record also to a file</span></code></pre></td></tr></table></div></figure>


<p>The key element here is the [input] section. Here we specify the Alsa device from which to source audio for capturing and encoding.</p>

<p>The other element in the config file that you need to configure is the [icecast-2]. Set the address (server and port) as well as the password to the icecast-2 server. Note that the default configuration for the icecast-2 server is only two (2) streams. Be sure to increase that if you&rsquo;re attempting to stream more than that to the server.</p>

<p>If you want to encode more than one stream on your Pi, you can run multiple instances of DarkIce and use the <strong>-c</strong> flag to specify a unique configuration file for each instance.</p>

<p>To configure <a href="http://www.icecast.org">Icecast</a>, start here. The <a href="http://www.icecast.org/docs/">Docs</a> are also a good starting point too. For the impatient you can just use apt-get.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>apt-get install icecast</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/15/vextab-awesomness-for-musical-notiation/">VexTab! Musical Notiation in HTML</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-04-15T15:07:08-04:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>3:07 pm</span></time>
        
           | <a href="/blog/2015/04/15/vextab-awesomness-for-musical-notiation/#disqus_thread"
             data-disqus-identifier="http://rabarar.github.io/blog/2015/04/15/vextab-awesomness-for-musical-notiation/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Using JavaScript to Write Music!</h2>

<h3><a href="http://www.vexflow.com/vextab/">VexFlow, VexTab</a> - Musical Engraving in Javascript</h3>

<p>I&rsquo;m very excited!! I randomly found a great piece of software developed by <strong>Mohit Muthanna Cheppudira</strong> that generates Musical notation and Guitar Tab.</p>

<p>Download the <a href="http://github.com/0xfe/vextab">javascript</a> or use the <a href="https://chrome.google.com/webstore/detail/npcffdibegeppkebphaghnpkcjcpopjf">Chrome Extension</a> and you can quickly encode musical notation like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>tabstave
</span><span class='line'>  notation=true
</span><span class='line'>  key=A time=4/4
</span><span class='line'>
</span><span class='line'>  notes :q =|: (5/2.5/3.7/4) :8 7-5h6/3 ^3^ 5h6-7/5 ^3^ :q 7V/4 |
</span><span class='line'>  notes :8 t12p7/4 s5s3/4 :8 3s:16:5-7/5 :h p5/4
</span><span class='line'>  text :w, |#segno, ,|, :hd, , #tr
</span></code></pre></td></tr></table></div></figure>


<p>And get beautifully formatted musical notation like this:</p>

<p><img src="/images/staff.png" alt="fig A" /></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/03/01/code-doodling-with-go/">Code Doodling With Go</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-03-01T13:11:00-05:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2015</span></span> <span class='time'>1:11 pm</span></time>
        
           | <a href="/blog/2015/03/01/code-doodling-with-go/#disqus_thread"
             data-disqus-identifier="http://rabarar.github.io/blog/2015/03/01/code-doodling-with-go/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Today, the weather was less than attractive so I thought I&rsquo;d play around with Go routines, channels, and functions.</p>

<p>Take a look at the following code:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="kn">package</span> <span class="nx">main</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="s">&quot;fmt&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">type</span> <span class="nx">fTyp</span> <span class="kd">struct</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">Doer</span>   <span class="kd">func</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="kt">error</span>
</span><span class='line'>        <span class="nx">Seeker</span> <span class="kd">func</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="kt">error</span><span class="p">)</span> <span class="kt">error</span>
</span><span class='line'>        <span class="nx">Wander</span> <span class="kd">func</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="kt">error</span><span class="p">)</span> <span class="kt">error</span><span class="p">)</span> <span class="kt">error</span>
</span><span class='line'>        <span class="nx">With</span>   <span class="kt">int</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">do</span> <span class="p">=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="nx">fTyp</span><span class="p">)</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">o</span> <span class="nx">fTyp</span> <span class="p">=</span> <span class="nx">fTyp</span><span class="p">{</span><span class="nx">Doer</span><span class="p">:</span> <span class="nx">foo</span><span class="p">,</span> <span class="nx">Seeker</span><span class="p">:</span> <span class="nx">bar</span><span class="p">,</span> <span class="nx">Wander</span><span class="p">:</span> <span class="nx">wander</span><span class="p">,</span> <span class="nx">With</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">go</span> <span class="kd">func</span><span class="p">(</span><span class="nx">f</span> <span class="nx">fTyp</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">do</span> <span class="o">&lt;-</span> <span class="nx">f</span>
</span><span class='line'>        <span class="p">}(</span><span class="nx">o</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">stuff</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="nx">do</span>
</span><span class='line'>        <span class="nx">stuff</span><span class="p">.</span><span class="nx">Doer</span><span class="p">(</span><span class="nx">stuff</span><span class="p">.</span><span class="nx">With</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">stuff</span><span class="p">.</span><span class="nx">Seeker</span><span class="p">(</span><span class="nx">stuff</span><span class="p">.</span><span class="nx">With</span><span class="p">,</span> <span class="nx">stuff</span><span class="p">.</span><span class="nx">Doer</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">stuff</span><span class="p">.</span><span class="nx">Wander</span><span class="p">(</span><span class="nx">stuff</span><span class="p">.</span><span class="nx">With</span><span class="p">,</span> <span class="nx">stuff</span><span class="p">.</span><span class="nx">Seeker</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">foo</span><span class="p">(</span><span class="nx">id</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;foo: %d\n&quot;</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span>
</span><span class='line'>        <span class="k">return</span> <span class="kc">nil</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">bar</span><span class="p">(</span><span class="nx">id</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">f</span> <span class="kd">func</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="kt">error</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">f</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
</span><span class='line'>        <span class="k">return</span> <span class="kc">nil</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">wander</span><span class="p">(</span><span class="nx">id</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">f</span> <span class="kd">func</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="kt">error</span><span class="p">)</span> <span class="kt">error</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">f</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">foo</span><span class="p">)</span>
</span><span class='line'>        <span class="k">return</span> <span class="kc">nil</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Who&rsquo;s ready to go (no pun intended) a step further and create an additional member to the <strong>fTyp struct</strong> and corresponding functions that will extend the meta-abstraction passing <strong>stuff.Wander</strong> as a parameter?</p>

<p>The things we do in the name of entertainment!</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/2">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2017/03/22/get-you-some-elixir/">Climbing Mt. Elixir/Erlang</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/08/06/chip-gsm-and-gps-a-cheap-linux-mobile-platform/">CHIP GSM and GPS - a Cheap Linux Mobile Platform</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/02/05/open-weather-api-and-golang/">Open Weather API and Golang</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/29/cgo-and-destructors-for-managing-allocated-memory-in-go/">Cgo and Destructors for Managing Allocated Memory in Go</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/22/jetson-tk-1-nvidia-l4t-linux-platform/">Jetson TK-1 Nvidia L4T Linux Platform</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2017 - Rob Baruch -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
  <a href='http://www.facebook.com/robertbaruch' target='_blank'>
	    <img src='/images/footer/facebook-48.png' align=right style="display:inline;margin:2px 2px 2px 5px;">
    </a>

      <a href='https://twitter.com/rabarar' target='_blank'>
	        <img src='/images/footer/twitter-48.png' align=right style="display:inline;margin:2px 2px 2px 5px;">
	</a>

	<a href='https://github.com/rabarar' target='_blank'>
		  <img src='/images/footer/github-48.png' align=right style="display:inline;margin:2px 2px 2px 5px;">
	  </a>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'rabarargithubio';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
